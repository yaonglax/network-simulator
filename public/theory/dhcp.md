# DHCP: автоматическое назначение IP-адресов

<h2 id="dhcp-principle">Принцип работы DHCP-сервера</h2><p>DHCP (Dynamic Host Configuration Protocol) — это сетевой протокол, позволяющий устройствам автоматически получать IP-адреса и другие параметры сети.</p><div style="position: relative; display: flex; justify-content: center; flex-direction: column; align-items: center; margin: 20px 0;"> <img width="70%" src="/theory/dhcp-server.png" style="border-radius: 0.5rem;" /> <div class='note'> DHCP-сервер хранит пул доступных IP-адресов и назначает их устройствам на временной основе, упрощая администрирование сети. <img src="/cat4.svg" style="position: absolute; bottom: 0; right: 0; translate: 50% 50%; transform: rotate(30deg); width: 120px;"> </div> </div><h3>Основные функции DHCP:</h3> <ul> <li>Автоматическое распределение IP-адресов</li> <li>Назначение маски подсети, шлюза и DNS-серверов</li> <li>Поддержка резервирования адресов для конкретных устройств</li> <li>Контроль времени аренды IP-адресов</li> </ul><h2 id="dhcp-dora">Процесс получения IP (DORA)</h2><p>Процесс получения IP-адреса по DHCP состоит из 4 этапов, известных как DORA:</p><div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin: 20px 0;"> <div style="border: 1px solid var(--detail-gray); border-radius: 0.5rem; padding: 15px;"> <h3 style="margin-top: 0;">1. Discover</h3> <p>Клиент отправляет широковещательный DHCPDISCOVER пакет для поиска доступных серверов.</p> </div> <div style="border: 1px solid var(--detail-gray); border-radius: 0.5rem; padding: 15px;"> <h3 style="margin-top: 0;">2. Offer</h3> <p>DHCP-сервер отвечает DHCPOFFER с предложением IP-адреса и параметров сети.</p> </div> <div style="border: 1px solid var(--detail-gray); border-radius: 0.5rem; padding: 15px;"> <h3 style="margin-top: 0;">3. Request</h3> <p>Клиент выбирает предложение и отправляет DHCPREQUEST для подтверждения.</p> </div> <div style="border: 1px solid var(--detail-gray); border-radius: 0.5rem; padding: 15px;"> <h3 style="margin-top: 0;">4. Acknowledge</h3> <p>Сервер подтверждает выделение адреса пакетом DHCPACK.</p> </div> </div><div style="position: relative; display: flex; justify-content: center; flex-direction: column; align-items: center; margin: 20px 0;"> <img src="/theory/dhcp-dora.png" style="width: 80%; border-radius: 0.5rem;"> <div class="note"> <strong>Важно:</strong> Весь процесс DORA происходит на канальном уровне (L2), поэтому работает даже без начального IP-адреса у клиента. <img src="/cat4.svg" style="position: absolute; bottom: 0; right: 0; translate: 50% 50%; transform: rotate(30deg); width: 120px;"> </div> </div><h2 id="dhcp-lease">Аренда адресов и обновление</h2><table> <thead> <tr> <th>Этап аренды</th> <th>Время</th> <th>Процесс</th> <th>Действия клиента</th> </tr> </thead> <tbody> <tr> <td><strong>Первоначальная аренда</strong></td> <td>T1 (обычно 50% времени аренды)</td> <td>Попытка обновления</td> <td>Отправка DHCPREQUEST текущему серверу</td> </tr> <tr> <td><strong>Продление аренды</strong></td> <td>T2 (обычно 87.5% времени аренды)</td> <td>Попытка найти любой сервер</td> <td>Широковещательный DHCPREQUEST</td> </tr> <tr> <td><strong>Завершение аренды</strong></td> <td>По истечении срока</td> <td>Освобождение адреса</td> <td>Отправка DHCPRELEASE (необязательно)</td> </tr> </tbody> </table><div style="position: relative; display: flex; justify-content: center; flex-direction: column; align-items: center; margin: 20px 0;"> <div class="note warning"> <strong>Типичные значения времени аренды:</strong><br> - Офисные сети: 8-24 часа<br> - Гостевые Wi-Fi: 1-4 часа<br> - Публичные сети: 30-60 минут <img src="/cat4.svg" style="position: absolute; bottom: 0; right: 0; translate: 50% 50%; transform: rotate(30deg); width: 120px;"> </div> </div><style> table { width: 100%; border-collapse: collapse; margin: 15px 0; } th, td { padding: 12px 15px; border: 1px solid var(--detail-gray); text-align: left; } th { background-color: var(--element-gray); font-weight: bold; } tr:nth-child(even) { background-color: var(--element-gray); } .note { border-left: 4px solid var(--highlight-purple); background-color: var(--element-gray); width: 80%; min-height: 60px; border-radius: 0.5rem; padding: 15px; position: relative; margin-top: 15px; } .note.warning { border-left-color: var(--warning-orange); } code { background-color: #f0f0f0; padding: 2px 4px; border-radius: 3px; font-family: monospace; } @media (max-width: 768px) { .grid-container { grid-template-columns: 1fr; } .illustration img, .note { width: 95%; } } </style>
